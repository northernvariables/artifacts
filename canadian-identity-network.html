<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Canadian Identity Network Demo - Northern Variables</title>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide-react@latest/dist/lucide-react.umd.js"></script>

  <style>
    :root {
      --nv-primary: #1e40af;
      --nv-primary-dark: #1e3a8a;
      --nv-accent: #3b82f6;
      --nv-text: #1f2937;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    }

  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const lucideExports = window.LucideReact || window.lucideReact || null;
    const createEmojiIcon = (symbol) => {
      const Icon = ({ className = '', ...rest }) => (
        <span
          role="img"
          aria-hidden="true"
          className={`${className} inline-flex items-center justify-center`}
          {...rest}
        >
          {symbol}
        </span>
      );
      return Icon;
    };

    const getIcon = (name, fallbackSymbol) => {
      if (lucideExports && lucideExports[name]) {
        return lucideExports[name];
      }
      return createEmojiIcon(fallbackSymbol);
    };

    const Shield = getIcon('Shield', 'üõ°Ô∏è');
    const Key = getIcon('Key', 'üîë');
    const User = getIcon('User', 'üë§');
    const Users = getIcon('Users', 'üë•');
    const CheckCircle = getIcon('CheckCircle', '‚úÖ');
    const XCircle = getIcon('XCircle', '‚ùå');
    const AlertCircle = getIcon('AlertCircle', '‚ö†Ô∏è');
    const Network = getIcon('Network', 'üåê');
    const Smartphone = getIcon('Smartphone', 'üì±');
    const MapPin = getIcon('MapPin', 'üìç');
    const Calendar = getIcon('Calendar', 'üìÖ');
    const Lock = getIcon('Lock', 'üîí');
    const Flag = getIcon('Flag', 'üö©');
    const TrendingDown = getIcon('TrendingDown', 'üìâ');
    const AlertTriangle = getIcon('AlertTriangle', '‚ö†Ô∏è');
    const Clock = getIcon('Clock', '‚è∞');
    const Wifi = getIcon('Wifi', 'üì∂');
    const CheckSquare = getIcon('CheckSquare', '‚òëÔ∏è');
    const Eye = getIcon('Eye', 'üëÅÔ∏è');
    const EyeOff = getIcon('EyeOff', 'üôà');
    const Twitter = getIcon('Twitter', 'ùïè');
    const Linkedin = getIcon('Linkedin', 'in');
    const Github = getIcon('Github', 'üê±');
    const Mail = getIcon('Mail', '‚úâÔ∏è');
    const Bell = getIcon('Bell', 'üîî');
    const X = getIcon('X', '‚úñÔ∏è');

    // Provide a server-side proxy endpoint via window.__INTEREST_FORM_ENDPOINT__.
    // This avoids embedding private Make.com API keys in the client bundle.
    const INTEREST_FORM_ENDPOINT = window.__INTEREST_FORM_ENDPOINT__ || null;

    function CanadianIdentityApp() {
      const [screen, setScreen] = useState('intro');
      const [identity, setIdentity] = useState(null);
      const [legalFirstName, setLegalFirstName] = useState('');
      const [preferredFirstName, setPreferredFirstName] = useState('');
      const [lastName, setLastName] = useState('');
      const [showCeremony, setShowCeremony] = useState(false);
      const [ceremonyStep, setCeremonyStep] = useState('discover');
      const [verificationChecks, setVerificationChecks] = useState({});
      const [nearbyUsers, setNearbyUsers] = useState([]);
      const [selectedUsers, setSelectedUsers] = useState([]);
      const [addressData, setAddressData] = useState({
        address: '',
        city: '',
        province: '',
        postalCode: '',
        verificationCode: '',
        indigenousNation: ''
      });
      const [generatedCode, setGeneratedCode] = useState('');
      const [phoneData, setPhoneData] = useState({
        phoneNumber: '',
        verificationCode: '',
        method: 'sms'
      });
      const [phoneCode, setPhoneCode] = useState('');
      const [showAddSocial, setShowAddSocial] = useState(false);
      const [newSocialPlatform, setNewSocialPlatform] = useState('');
      const [newSocialHandle, setNewSocialHandle] = useState('');
      const [showInterestForm, setShowInterestForm] = useState(false);
      const [interestFormData, setInterestFormData] = useState({
        name: '',
        email: '',
        keepInformed: true,
        hostCeremonies: false
      });
      const [formSubmitted, setFormSubmitted] = useState(false);

      const generateKeyPair = () => {
        const publicKey = 'CA-DID:' + Math.random().toString(36).substring(2, 15);
        const keyFingerprint = 'CA' + Array.from({length: 2}, () =>
          Array.from({length: 4}, () => Math.floor(Math.random() * 16).toString(16).toUpperCase()).join('')
        ).join(':');
        return { publicKey, keyFingerprint };
      };

      const createIdentity = () => {
        const keys = generateKeyPair();
        const newIdentity = {
          ...keys,
          id: keys.publicKey,
          displayUsername: null,
          verified: false,
          physicalVouches: 0,
          requiredVouches: 3,
          vouchedBy: [],
          vouches: [],
          vouchesRevoked: 0,
          ceremoniesAttended: [],
          lastReVerification: null,
          reVerifications: 0,
          daysInNetwork: 0,
          createdAt: new Date().toISOString(),
          warnings: [],
          verifiedAddress: null,
          verifiedPhone: null,
          socialAccounts: []
        };
        setIdentity(newIdentity);
        setScreen('address');
      };

      const claimUsername = () => {
        if (legalFirstName && lastName) {
          const displayFirst = preferredFirstName || legalFirstName;
          const fullUsername = `${displayFirst.toLowerCase()}.${lastName.toLowerCase()}`;
          const updated = {
            ...identity,
            legalFirstName: legalFirstName,
            preferredFirstName: preferredFirstName || legalFirstName,
            lastName: lastName,
            displayUsername: fullUsername,
            claimedAt: new Date().toISOString(),
            socialAccounts: identity.socialAccounts || []
          };
          setIdentity(updated);
          setScreen('dashboard');
        }
      };

      const requestVerificationCode = () => {
        if (addressData.address && addressData.city && addressData.province && addressData.postalCode) {
          const code = Math.floor(100000 + Math.random() * 900000).toString();
          setGeneratedCode(code);
          alert(`Verification code sent!\n\nDemo code: ${code}`);
        } else {
          alert('Please fill in all address fields');
        }
      };

      const verifyAddress = () => {
        if (addressData.verificationCode === generatedCode) {
          const updated = {
            ...identity,
            verifiedAddress: {
              city: addressData.city,
              province: addressData.province,
              postalCode: addressData.postalCode.substring(0, 3),
              verifiedAt: new Date().toISOString()
            }
          };
          setIdentity(updated);
          setScreen('phone');
        } else {
          alert('Invalid verification code');
        }
      };

      const sendPhoneVerification = () => {
        const code = Math.floor(100000 + Math.random() * 900000).toString();
        setPhoneCode(code);
        alert(`${phoneData.method === 'sms' ? 'SMS' : 'Voice'} sent!\n\nDemo code: ${code}`);
      };

      const verifyPhone = () => {
        if (phoneData.verificationCode === phoneCode) {
          const digits = phoneData.phoneNumber.replace(/\D/g, '');
          const areaCode = digits.length === 11 ? digits.substring(1, 4) : digits.substring(0, 3);
          const updated = {
            ...identity,
            verifiedPhone: {
              areaCode: areaCode,
              method: phoneData.method,
              verifiedAt: new Date().toISOString()
            }
          };
          setIdentity(updated);
          setScreen('setup');
        } else {
          alert('Invalid verification code');
        }
      };

      const joinCeremony = () => {
        const nearby = [
          { displayUsername: 'alice.chen', distance: '2m', verified: true },
          { displayUsername: 'bob.macdonald', distance: '5m', verified: true },
          { displayUsername: 'carol.tremblay', distance: '8m', verified: true },
          { displayUsername: 'dave.morrison', distance: '12m', verified: false },
          { displayUsername: 'emily.lee', distance: '15m', verified: true }
        ];
        setNearbyUsers(nearby);
        setShowCeremony(true);
        setCeremonyStep('discover');
      };

      const toggleUserSelection = (username) => {
        if (selectedUsers.includes(username)) {
          setSelectedUsers(selectedUsers.filter(u => u !== username));
        } else if (selectedUsers.length < 9) {
          setSelectedUsers([...selectedUsers, username]);
        }
      };

      const proceedToSigning = () => {
        if (selectedUsers.length >= 2) {
          const checks = {};
          selectedUsers.forEach(user => {
            checks[user] = { identity: false, citizenship: false, address: false };
          });
          setVerificationChecks(checks);
          setCeremonyStep('verify');
        } else {
          alert('Select at least 2 others (minimum 3 total)');
        }
      };

      const toggleVerificationCheck = (username, checkType) => {
        setVerificationChecks(prev => ({
          ...prev,
          [username]: {
            ...prev[username],
            [checkType]: !prev[username][checkType]
          }
        }));
      };

      const allChecksComplete = () => {
        return Object.values(verificationChecks).every(checks =>
          checks.identity && checks.citizenship && checks.address
        );
      };

      const completeCeremony = () => {
        const vouchesReceived = selectedUsers.length;
        const ceremony = {
          participants: [identity.displayUsername, ...selectedUsers],
          quorumSize: selectedUsers.length + 1,
          ceremonyHash: 'SHA256:' + Math.random().toString(36).substring(2, 15),
          completedAt: new Date().toISOString()
        };

        const isReVerification = identity.verified;
        const updatedIdentity = {
          ...identity,
          physicalVouches: identity.physicalVouches + vouchesReceived,
          vouchedBy: isReVerification ? identity.vouchedBy : [...identity.vouchedBy, ...selectedUsers],
          ceremoniesAttended: [...identity.ceremoniesAttended, ceremony],
          verified: true,
          lastReVerification: new Date().toISOString(),
          reVerifications: isReVerification ? identity.reVerifications + 1 : 0
        };

        setIdentity(updatedIdentity);
        setCeremonyStep('complete');
      };

      const closeCeremony = () => {
        setShowCeremony(false);
        setCeremonyStep('discover');
        setSelectedUsers([]);
        setNearbyUsers([]);
        setVerificationChecks({});
      };

      const addSocialAccount = () => {
        if (newSocialPlatform && newSocialHandle) {
          const newAccount = {
            platform: newSocialPlatform,
            handle: newSocialHandle,
            verified: false,
            visible: true,
            oauthVerified: false,
            matchedFields: []
          };
          const updatedAccounts = [...(identity.socialAccounts || []), newAccount];
          setIdentity({ ...identity, socialAccounts: updatedAccounts });
          setNewSocialPlatform('');
          setNewSocialHandle('');
          setShowAddSocial(false);
        }
      };

      const toggleSocialVisibility = (index) => {
        const updatedAccounts = identity.socialAccounts.map((account, idx) =>
          idx === index ? { ...account, visible: !account.visible } : account
        );
        setIdentity({ ...identity, socialAccounts: updatedAccounts });
      };

      const verifySocialAccount = (index) => {
        const updatedAccounts = identity.socialAccounts.map((account, idx) =>
          idx === index
            ? {
                ...account,
                verified: true,
                oauthVerified: true,
                matchedFields: ['lastName', 'email']
              }
            : account
        );
        setIdentity({ ...identity, socialAccounts: updatedAccounts });
        alert(`OAuth 2.0 Verification\n\nIn production:\n1. Redirect to ${updatedAccounts[index].platform}\n2. Authorize access\n3. Match: lastName & email\n\nDemo: Verified!`);
      };

      const removeSocialAccount = (index) => {
        const updatedAccounts = identity.socialAccounts.filter((_, idx) => idx !== index);
        setIdentity({ ...identity, socialAccounts: updatedAccounts });
      };

      const submitInterestForm = async () => {
        if (interestFormData.name && interestFormData.email) {
          try {
            const submissionData = {
              name: interestFormData.name,
              email: interestFormData.email,
              keepInformed: interestFormData.keepInformed,
              hostCeremonies: interestFormData.hostCeremonies,
              submittedAt: new Date().toISOString()
            };

            if (identity && identity.displayUsername) {
              submissionData.desiredUsername = identity.displayUsername;
              submissionData.legalFirstName = identity.legalFirstName;
              submissionData.preferredFirstName = identity.preferredFirstName;
              submissionData.lastName = identity.lastName;
            }

            if (!INTEREST_FORM_ENDPOINT) {
              console.error('Interest form endpoint not configured. Set window.__INTEREST_FORM_ENDPOINT__ to a server-side proxy URL.');
              alert('Submission temporarily unavailable. Please try again later.');
              return;
            }

            const response = await fetch(INTEREST_FORM_ENDPOINT, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(submissionData)
            });

            if (response.ok) {
              console.log('Form submitted successfully to webhook');
              setFormSubmitted(true);
              setTimeout(() => {
                setShowInterestForm(false);
                setFormSubmitted(false);
                setInterestFormData({
                  name: '',
                  email: '',
                  keepInformed: true,
                  hostCeremonies: false
                });
              }, 2000);
            } else {
              console.error('Webhook submission failed:', response.status);
              alert('Submission failed. Please try again.');
            }
          } catch (error) {
            console.error('Error submitting to webhook:', error);
            alert('Network error. Please check your connection and try again.');
          }
        } else {
          alert('Please provide name and email');
        }
      };

      const resetApp = () => {
        setIdentity(null);
        setLegalFirstName('');
        setPreferredFirstName('');
        setLastName('');
        setShowCeremony(false);
        setCeremonyStep('discover');
        setSelectedUsers([]);
        setNearbyUsers([]);
        setVerificationChecks({});
        setAddressData({ address: '', city: '', province: '', postalCode: '', verificationCode: '', indigenousNation: '' });
        setGeneratedCode('');
        setPhoneData({ phoneNumber: '', verificationCode: '', method: 'sms' });
        setPhoneCode('');
        setShowAddSocial(false);
        setNewSocialPlatform('');
        setNewSocialHandle('');
        setShowInterestForm(false);
        setScreen('intro');
      };

      const getTrustScore = () => {
        if (!identity || !identity.verified) return 0;
        let score = 40;
        score += Math.min(25, Math.max(0, identity.physicalVouches - 3) * 5);
        score += Math.min(15, (identity.daysInNetwork / 365) * 15);
        score += Math.min(10, identity.reVerifications * 5);
        return Math.max(0, Math.min(100, Math.round(score)));
      };

      const interestFormConfigured = Boolean(INTEREST_FORM_ENDPOINT);

      const InterestFormModal = () => {
        if (!showInterestForm) return null;

        const hasCreatedUsername = identity && identity.displayUsername;

        return (
          <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
            <div className="bg-slate-800 rounded-2xl max-w-md w-full p-8 border-2 border-red-500 relative">
              <button
                onClick={() => setShowInterestForm(false)}
                className="absolute top-4 right-4 text-slate-400 hover:text-white"
              >
                <X className="w-6 h-6" />
              </button>

              <div className="text-center mb-6">
                <div className="text-5xl mb-3">üçÅ</div>
                <h2 className="text-2xl font-bold mb-2">Reserve Your Username</h2>
                <p className="text-slate-300 text-sm">
                  Be notified when the Canadian Identity Network launches and secure your username.
                </p>
              </div>

              {!formSubmitted ? (
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-semibold text-red-300 mb-2">Name</label>
                    <input
                      type="text"
                      value={interestFormData.name}
                      onChange={(e) => setInterestFormData({...interestFormData, name: e.target.value})}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      placeholder="Your name"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-semibold text-red-300 mb-2">Email</label>
                    <input
                      type="email"
                      value={interestFormData.email}
                      onChange={(e) => setInterestFormData({...interestFormData, email: e.target.value})}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      placeholder="your.email@example.com"
                    />
                  </div>

                  {hasCreatedUsername && (
                    <div className="bg-blue-900 bg-opacity-30 border border-blue-500 rounded-lg p-4">
                      <label className="block text-sm font-semibold text-blue-200 mb-2">
                        Desired Username
                      </label>
                      <div className="bg-slate-900 px-4 py-3 rounded-lg border border-slate-600">
                        <div className="font-mono text-white">@{identity.displayUsername}</div>
                      </div>
                      <p className="text-xs text-blue-200 mt-2">
                        From your demo profile. We'll reserve this for you!
                      </p>
                    </div>
                  )}

                  <div className="bg-yellow-900 bg-opacity-20 border border-yellow-600 rounded-lg p-3">
                    <p className="text-xs text-yellow-200">
                      <strong>Note on duplicate names:</strong> Usernames are first-come, first-served. If your name is taken, you'll be able to add a middle initial (e.g., john.m.smith) or number suffix (e.g., john.smith.2) when you join.
                    </p>
                  </div>

                  <div className="space-y-3 pt-2">
                    <label className="flex items-start gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={interestFormData.keepInformed}
                        onChange={(e) => setInterestFormData({...interestFormData, keepInformed: e.target.checked})}
                        className="mt-1 w-4 h-4"
                      />
                      <div>
                        <div className="text-sm font-medium text-white">Keep me informed about launch</div>
                        <div className="text-xs text-slate-400">Receive updates when we go live</div>
                      </div>
                    </label>

                    <label className="flex items-start gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={interestFormData.hostCeremonies}
                        onChange={(e) => setInterestFormData({...interestFormData, hostCeremonies: e.target.checked})}
                        className="mt-1 w-4 h-4"
                      />
                      <div>
                        <div className="text-sm font-medium text-white">I'm interested in hosting ceremonies in my community</div>
                        <div className="text-xs text-slate-400">Help organize verification events</div>
                      </div>
                    </label>
                  </div>

              <button
                onClick={submitInterestForm}
                disabled={!interestFormConfigured}
                className={`w-full py-3 rounded-lg font-semibold transition ${
                  interestFormConfigured
                    ? 'bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900'
                    : 'bg-slate-700 cursor-not-allowed'
                }`}
              >
                {interestFormConfigured ? 'Reserve Username' : 'Submission Unavailable'}
              </button>

              {!interestFormConfigured && (
                <p className="text-xs text-yellow-400 text-center">
                  Configure a secure server-side endpoint and expose it as window.__INTEREST_FORM_ENDPOINT__ to enable submissions.
                </p>
              )}

                  <p className="text-center text-xs text-slate-500 mt-4">
                    ¬© {new Date().getFullYear()} Connexxia Inc.
                  </p>
                </div>
              ) : (
                <div className="text-center py-8">
                  <CheckCircle className="w-16 h-16 text-green-400 mx-auto mb-4" />
                  <h3 className="text-xl font-bold text-green-300 mb-2">Username Reserved!</h3>
                  <p className="text-slate-300 text-sm">
                    We'll notify you when the Canadian Identity Network launches.
                  </p>
                  {hasCreatedUsername && (
                    <p className="text-sm text-blue-300 mt-2">
                      @{identity.displayUsername} has been reserved for you.
                    </p>
                  )}
                  <p className="text-xs text-slate-500 mt-6">
                    ¬© {new Date().getFullYear()} Connexxia Inc.
                  </p>
                </div>
              )}
            </div>
          </div>
        );
      };

      if (screen === 'intro') {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
              <div className="max-w-5xl mx-auto py-12">
                <div className="text-center mb-8">
                  <div className="inline-flex items-center justify-center w-24 h-24 bg-white rounded-full mb-4 shadow-lg">
                    <div className="text-6xl">üçÅ</div>
                  </div>
                  <h1 className="text-5xl font-bold mb-3">Canadian Identity Network</h1>
                  <p className="text-xl text-red-200 mb-2">Verified Canadians. Real Conversations.</p>
                  <p className="text-lg text-slate-300 italic">&quot;By Canadians, For Canadians&quot;</p>
                </div>

                <div className="bg-slate-800 bg-opacity-50 backdrop-blur rounded-2xl p-8 mb-8 border-2 border-red-500">
                  <h2 className="text-2xl font-bold mb-6 flex items-center gap-3">
                    <span className="text-3xl">üá®üá¶</span>
                    The Canadian Solution
                  </h2>
                  <div className="space-y-4 text-slate-100">
                    <p>
                      Online Canadian spaces are flooded with bots and foreign actors. <strong className="text-white">How do you know you're talking to a real Canadian?</strong>
                    </p>
                    <p>
                      The Canadian Identity Network uses <strong className="text-white">mobile app + multi-signature ceremonies</strong> where Canadians meet in person and cryptographically verify each other. More signatures = stronger proof.
                    </p>
                  </div>
                </div>

                <div className="bg-green-900 bg-opacity-20 border-2 border-green-500 rounded-xl p-6 mb-8">
                  <h3 className="font-bold text-green-200 mb-4 text-xl flex items-center gap-2">
                    <Lock className="w-6 h-6" />
                    Privacy First - No Government Access
                  </h3>
                  <div className="space-y-3 text-sm text-green-100">
                    <div className="flex gap-3">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">No government involvement:</strong> This is a community-run network. No information is shared with any government entity.
                      </div>
                    </div>
                    <div className="flex gap-3">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">No ID storage:</strong> We never store copies of your ID. During ceremonies, people simply attest they verified you - no documents are uploaded or retained.
                      </div>
                    </div>
                    <div className="flex gap-3">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">Decentralized verification:</strong> Your identity is cryptographically proven by real people who met you, not by a central authority.
                      </div>
                    </div>
                    <div className="flex gap-3">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">You control your data:</strong> Only information you choose to make public (name, social accounts) is visible. All keys stay on your device.
                      </div>
                    </div>
                  </div>
                </div>

                <div className="grid md:grid-cols-3 gap-4 mb-8">
                  <div className="bg-slate-800 bg-opacity-50 backdrop-blur rounded-xl p-6 border border-slate-700">
                    <Smartphone className="w-8 h-8 text-red-400 mb-3" />
                    <h3 className="font-bold text-lg mb-2 text-red-300">Mobile App</h3>
                    <p className="text-sm text-slate-300">Your identity lives on your phone, secured by cryptographic keys</p>
                  </div>
                  <div className="bg-slate-800 bg-opacity-50 backdrop-blur rounded-xl p-6 border border-slate-700">
                    <Users className="w-8 h-8 text-blue-400 mb-3" />
                    <h3 className="font-bold text-lg mb-2 text-red-300">Multi-Signature Quorum</h3>
                    <p className="text-sm text-slate-300">Meet in person, form a group (3-10 people), all sign together</p>
                  </div>
                  <div className="bg-slate-800 bg-opacity-50 backdrop-blur rounded-xl p-6 border border-slate-700">
                    <Key className="w-8 h-8 text-green-400 mb-3" />
                    <h3 className="font-bold text-lg mb-2 text-red-300">Multi-Signature</h3>
                    <p className="text-sm text-slate-300">All participants sign the attestation - cryptographic proof you all met</p>
                  </div>
                </div>

                <div className="bg-red-900 bg-opacity-30 border-2 border-red-500 rounded-xl p-6 mb-8">
                  <h3 className="font-bold text-red-200 mb-4 text-xl">üîí How Multi-Signature Ceremonies Work</h3>
                  <div className="space-y-3 text-sm text-slate-300">
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">1</div>
                      <p>Multiple people physically meet at a ceremony location (minimum 3, maximum 10 for practical coordination)</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">2</div>
                      <p>Open mobile app and discover nearby users via Bluetooth/NFC</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">3</div>
                      <p>Each person selects the others to form a quorum (more signatures = stronger verification)</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">4</div>
                      <p><strong className="text-white">Verify each person:</strong> Check that username is a reasonable interpretation of legal name (e.g., Marcus ‚Üí Mark), citizenship/residency, and address for all others</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">5</div>
                      <p><strong className="text-white">Sign attestations:</strong> All participants cryptographically sign that verifications were completed</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">6</div>
                      <p>Multi-signed attestations transmitted to network by all participants</p>
                    </div>
                    <div className="flex gap-2">
                      <div className="flex-shrink-0 w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold">7</div>
                      <p><strong className="text-white">Result:</strong> Each person receives N-1 vouches (where N = quorum size). Larger ceremonies = more vouches!</p>
                    </div>
                  </div>
                </div>

                <div className="bg-blue-900 bg-opacity-20 border border-blue-500 rounded-xl p-6 mb-8">
                  <h3 className="font-bold text-blue-200 mb-3 text-lg">What Each Person Attests To</h3>
                  <div className="space-y-3 text-sm text-slate-300">
                    <div className="flex gap-2">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">Name Verification:</strong> This person's username is a reasonable interpretation of their legal name (verified by photo ID, government documents, or personal knowledge). Examples: Marcus ‚Üí Mark, Elizabeth ‚Üí Liz, Robert ‚Üí Bob
                      </div>
                    </div>
                    <div className="flex gap-2">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">Citizenship/Residency:</strong> This person is a Canadian citizen or permanent resident (verified by documents or confirmation)
                      </div>
                    </div>
                    <div className="flex gap-2">
                      <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                      <div>
                        <strong className="text-white">Address:</strong> This person lives at the address they claim in Canada (verified by mail, utility bill, lease, or personal knowledge)
                      </div>
                    </div>
                  </div>
                  <div className="mt-4 p-3 bg-cyan-900 bg-opacity-30 border border-cyan-600 rounded text-xs text-cyan-200">
                    <strong>Username = Your Name (or variation):</strong> Your username will be <span className="font-mono">firstname.lastname</span> where first name can be a reasonable variation like a nickname (e.g., mark.johnson for Marcus Johnson).
                  </div>
                  <div className="mt-2 p-3 bg-purple-900 bg-opacity-30 border border-purple-600 rounded text-xs text-purple-200">
                    <strong>üîó Connect Social Media:</strong> After verification, link your Twitter/X, Reddit, LinkedIn, GitHub via OAuth 2.0. The system matches your last name and email to prove the accounts belong to you.
                  </div>
                  <div className="mt-2 p-3 bg-green-900 bg-opacity-30 border border-green-600 rounded text-xs text-green-200">
                    <strong>üí™ Larger ceremonies = stronger proof:</strong> In a 10-person ceremony, you get 9 vouches instead of 2 from a 3-person ceremony. More independent attestations = stronger verification!
                  </div>
                  <div className="mt-2 p-3 bg-yellow-900 bg-opacity-30 border border-yellow-600 rounded text-xs text-yellow-200">
                    <strong>Accountability:</strong> All attestations are cryptographically signed. False attestations damage your trust score and can result in network removal.
                  </div>
                </div>

                <button
                  onClick={createIdentity}
                  className="w-full bg-gradient-to-r from-red-600 to-red-800 py-4 rounded-xl font-bold text-lg hover:from-red-700 hover:to-red-900 transition shadow-lg border-2 border-white border-opacity-20 mb-4"
                >
                  üçÅ Try the Demo
                </button>

                <div className="text-center mb-3">
                  <div className="inline-block bg-slate-800 bg-opacity-50 px-4 py-1 rounded-full text-sm text-slate-300">
                    or
                  </div>
                </div>

                <button
                  onClick={() => setShowInterestForm(true)}
                  className="w-full bg-slate-800 bg-opacity-50 backdrop-blur border-2 border-blue-500 py-4 rounded-xl font-semibold text-lg hover:bg-slate-700 transition shadow-lg flex items-center justify-center gap-2"
                >
                  <User className="w-5 h-5" />
                  Reserve Your Username
                </button>

                <p className="text-center text-xs text-slate-400 mt-3">
                  Interested in hosting verification ceremonies in your community? Let us know in the form above.
                </p>

                <div className="text-center mt-8 pt-8 border-t border-slate-700">
                  <p className="text-xs text-slate-500">
                    ¬© {new Date().getFullYear()} Connexxia Inc. All rights reserved.
                  </p>
                </div>
              </div>
            </div>
          </>
        );
      }

      if (screen === 'address') {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
              <div className="max-w-3xl mx-auto py-12">
                <div className="bg-slate-800 rounded-2xl p-8 border-2 border-red-500">
                  <div className="text-center mb-8">
                    <MapPin className="w-12 h-12 mx-auto mb-4 text-red-400" />
                    <h1 className="text-3xl font-bold mb-2">Verify Canadian Address</h1>
                  </div>

                  <div className="space-y-4 mb-6">
                    <input
                      type="text"
                      value={addressData.address}
                      onChange={(e) => setAddressData({...addressData, address: e.target.value})}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      placeholder="123 Maple Street"
                    />

                    <div className="grid md:grid-cols-2 gap-4">
                      <input
                        type="text"
                        value={addressData.city}
                        onChange={(e) => setAddressData({...addressData, city: e.target.value})}
                        className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                        placeholder="City"
                      />
                      <select
                        value={addressData.province}
                        onChange={(e) => setAddressData({...addressData, province: e.target.value})}
                        className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      >
                        <option value="">Province/Territory</option>
                        <option value="AB">Alberta</option>
                        <option value="BC">British Columbia</option>
                        <option value="MB">Manitoba</option>
                        <option value="NB">New Brunswick</option>
                        <option value="NL">Newfoundland and Labrador</option>
                        <option value="NT">Northwest Territories</option>
                        <option value="NS">Nova Scotia</option>
                        <option value="NU">Nunavut</option>
                        <option value="ON">Ontario</option>
                        <option value="PE">Prince Edward Island</option>
                        <option value="QC">Quebec</option>
                        <option value="SK">Saskatchewan</option>
                        <option value="YT">Yukon</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-red-300 mb-2">First Nation, Inuit or M√©tis Community (Optional)</label>
                      <input
                        type="text"
                        value={addressData.indigenousNation}
                        onChange={(e) => setAddressData({...addressData, indigenousNation: e.target.value})}
                        className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                        placeholder="e.g., Mohawk Nation, Nunavut Inuit, M√©tis Nation of Ontario"
                      />
                      <p className="text-xs text-slate-400 mt-1">
                        For members of First Nations, Inuit or M√©tis communities who wish to identify their nation or community
                      </p>
                    </div>

                    <input
                      type="text"
                      value={addressData.postalCode}
                      onChange={(e) => setAddressData({...addressData, postalCode: e.target.value.toUpperCase()})}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      placeholder="Postal Code"
                      maxLength="7"
                    />
                  </div>

                  {!generatedCode ? (
                    <button onClick={requestVerificationCode} className="w-full bg-red-600 py-3 rounded-lg font-semibold">
                      Send Code
                    </button>
                  ) : (
                    <div className="space-y-4">
                      <div className="bg-green-900 bg-opacity-20 border border-green-600 rounded-xl p-4">
                        <p className="text-sm text-green-100">Demo code: {generatedCode}</p>
                      </div>
                      <input
                        type="text"
                        value={addressData.verificationCode}
                        onChange={(e) => setAddressData({...addressData, verificationCode: e.target.value})}
                        className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white text-center text-2xl"
                        placeholder="000000"
                        maxLength="6"
                      />
                      <button onClick={verifyAddress} className="w-full bg-green-600 py-3 rounded-lg font-semibold">
                        Verify & Continue
                      </button>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </>
        );
      }

      if (screen === 'phone') {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
              <div className="max-w-3xl mx-auto py-12">
                <div className="bg-slate-800 rounded-2xl p-8 border-2 border-red-500">
                  <div className="text-center mb-8">
                    <div className="text-4xl mb-4">üì±</div>
                    <h1 className="text-3xl font-bold mb-2">Verify Phone</h1>
                  </div>

                  <div className="space-y-4 mb-6">
                    <input
                      type="tel"
                      value={phoneData.phoneNumber}
                      onChange={(e) => setPhoneData({...phoneData, phoneNumber: e.target.value})}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                      placeholder="416-555-0123"
                    />
                    <div className="grid grid-cols-2 gap-3">
                      <button
                        onClick={() => setPhoneData({...phoneData, method: 'sms'})}
                        className={`p-4 rounded-lg border-2 ${phoneData.method === 'sms' ? 'border-blue-500 bg-blue-900 bg-opacity-30' : 'border-slate-600'}`}
                      >
                        <div className="text-2xl mb-2">üí¨</div>
                        <div className="font-semibold text-sm">SMS</div>
                      </button>
                      <button
                        onClick={() => setPhoneData({...phoneData, method: 'voice'})}
                        className={`p-4 rounded-lg border-2 ${phoneData.method === 'voice' ? 'border-blue-500 bg-blue-900 bg-opacity-30' : 'border-slate-600'}`}
                      >
                        <div className="text-2xl mb-2">üìû</div>
                        <div className="font-semibold text-sm">Voice</div>
                      </button>
                    </div>
                  </div>

                  {!phoneCode ? (
                    <button onClick={sendPhoneVerification} className="w-full bg-blue-600 py-3 rounded-lg font-semibold">
                      Send Code
                    </button>
                  ) : (
                    <div className="space-y-4">
                      <div className="bg-green-900 bg-opacity-20 border border-green-600 rounded-xl p-4">
                        <p className="text-sm text-green-100">Demo code: {phoneCode}</p>
                      </div>
                      <input
                        type="text"
                        value={phoneData.verificationCode}
                        onChange={(e) => setPhoneData({...phoneData, verificationCode: e.target.value})}
                        className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white text-center text-2xl"
                        placeholder="000000"
                        maxLength="6"
                      />
                      <button onClick={verifyPhone} className="w-full bg-green-600 py-3 rounded-lg font-semibold">
                        Verify & Continue
                      </button>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </>
        );
      }

      if (screen === 'trustScoreInfo') {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
              <div className="max-w-4xl mx-auto py-12">
                <button
                  onClick={() => setScreen('dashboard')}
                  className="mb-6 px-4 py-2 bg-slate-800 border border-slate-600 rounded-lg hover:bg-slate-700 transition flex items-center gap-2"
                >
                  ‚Üê Back to Profile
                </button>

                <div className="bg-slate-800 bg-opacity-50 backdrop-blur rounded-2xl p-8 border-2 border-red-500 mb-6">
                  <div className="text-center mb-8">
                    <div className="text-5xl mb-4">ü§ù</div>
                    <h1 className="text-4xl font-bold mb-3">Understanding Your Trust Score</h1>
                    <p className="text-xl text-red-200">Peer Verification, Not Government Control</p>
                  </div>

                  <div className="bg-blue-900 bg-opacity-30 border-2 border-blue-500 rounded-xl p-6 mb-8">
                    <h2 className="text-2xl font-bold mb-4 text-blue-200">What Your Score Actually Means</h2>
                    <div className="space-y-4 text-slate-100">
                      <p className="text-lg">
                        <strong className="text-white">Your trust score is NOT a reputation system.</strong> It doesn't judge your character, beliefs, or social standing.
                      </p>
                      <p>
                        Instead, it simply shows: <strong className="text-white">"How many real Canadians have personally met you and vouched that you are who you say you are?"</strong>
                      </p>
                      <p>
                        This is peer-to-peer verification - Canadians validating other Canadians through direct, in-person meetings. No government involvement. No central authority deciding your worth.
                      </p>
                    </div>
                  </div>

                  <div className="bg-green-900 bg-opacity-20 border-2 border-green-500 rounded-xl p-6 mb-8">
                    <h2 className="text-2xl font-bold mb-4 text-green-200 flex items-center gap-2">
                      <Shield className="w-7 h-7" />
                      Not a Social Credit System
                    </h2>
                    <div className="space-y-4 text-slate-100">
                      <p>
                        Many Canadians are rightfully concerned about government digital IDs and social credit systems. <strong className="text-white">This is the opposite.</strong>
                      </p>
                      <div className="space-y-3 text-sm">
                        <div className="flex gap-3">
                          <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                          <div>
                            <strong className="text-white">No government database:</strong> Your identity isn't tracked by any government agency. It's stored on your device, verified by your community.
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                          <div>
                            <strong className="text-white">No behavioral tracking:</strong> The score doesn't measure your opinions, purchases, or activities. Only: "Did other Canadians verify your identity?"
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                          <div>
                            <strong className="text-white">Community sovereignty:</strong> Your neighbors verify you, not bureaucrats. This is local trust, not centralized control.
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                          <div>
                            <strong className="text-white">Voluntary participation:</strong> No one forces you to join. You choose to participate because online spaces are flooded with bots and bad actors.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div className="bg-slate-900 bg-opacity-50 border border-slate-600 rounded-xl p-6 mb-8">
                    <h2 className="text-2xl font-bold mb-4">How The Score Is Calculated</h2>
                    <div className="space-y-4">
                      <div className="bg-slate-800 rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-semibold text-white">Base Verification</span>
                          <span className="text-red-300 font-bold">40 points</span>
                        </div>
                        <p className="text-sm text-slate-300">
                          You met with other Canadians in person. They verified your identity, citizenship, and address. That's it.
                        </p>
                      </div>

                      <div className="bg-slate-800 rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-semibold text-white">Additional Vouches</span>
                          <span className="text-red-300 font-bold">+5 points each (max +25)</span>
                        </div>
                        <p className="text-sm text-slate-300">
                          More Canadians verified you at ceremonies. Each additional person who says "Yes, I met this person" adds credibility.
                        </p>
                      </div>

                      <div className="bg-slate-800 rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-semibold text-white">Time in Network</span>
                          <span className="text-red-300 font-bold">+15 points (over 1 year)</span>
                        </div>
                        <p className="text-sm text-slate-300">
                          You've been verified for a long time. Bots and fake accounts don't stick around.
                        </p>
                      </div>

                      <div className="bg-slate-800 rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-semibold text-white">Re-Verifications</span>
                          <span className="text-red-300 font-bold">+5 points each (max +10)</span>
                        </div>
                        <p className="text-sm text-slate-300">
                          Every 6 months, you meet with other Canadians again to confirm you're still active and legitimate. This prevents stolen or sold accounts.
                        </p>
                      </div>

                      <div className="bg-slate-800 rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-semibold text-white">Community Participation</span>
                          <span className="text-red-300 font-bold">+10 points</span>
                        </div>
                        <p className="text-sm text-slate-300">
                          You've helped verify others. You're building the community, not just taking from it.
                        </p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-yellow-900 bg-opacity-20 border-2 border-yellow-500 rounded-xl p-6 mb-8">
                    <h2 className="text-2xl font-bold mb-4 text-yellow-200">Why This Matters</h2>
                    <div className="space-y-4 text-slate-100">
                      <p>
                        Online, you can't tell if you're talking to a real Canadian or a bot, troll farm, or foreign operative. Reddit's /r/canada is full of accounts that aren't Canadian. Twitter discussions about Canadian politics are manipulated by fake accounts.
                      </p>
                      <p>
                        <strong className="text-white">This system solves that problem through social engineering, not government mandate.</strong>
                      </p>
                      <p>
                        Real Canadians meet face-to-face. They look at each other's IDs (driver's license, passport, whatever). They confirm: "Yes, this is a real person who lives in Canada." Then they cryptographically sign that attestation.
                      </p>
                      <p>
                        It's the same way you'd verify someone in real life - by meeting them and checking their identity. Except now, that verification is portable across the internet.
                      </p>
                    </div>
                  </div>

                  <div className="bg-red-900 bg-opacity-20 border-2 border-red-500 rounded-xl p-6">
                    <h2 className="text-2xl font-bold mb-4 text-red-200">Your Data, Your Control</h2>
                    <div className="space-y-4 text-slate-100">
                      <p>
                        <strong className="text-white">This isn't about surveillance.</strong> It's about authenticity.
                      </p>
                      <div className="space-y-3 text-sm">
                        <div className="flex gap-3">
                          <Lock className="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" />
                          <div>
                            Your cryptographic keys live on your device. No central server holds your identity.
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <Lock className="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" />
                          <div>
                            No one stores your ID documents. People simply attest they verified you.
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <Lock className="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" />
                          <div>
                            You choose what information to make public. Want to stay anonymous online? Only share your verified status, not your name.
                          </div>
                        </div>
                        <div className="flex gap-3">
                          <Lock className="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" />
                          <div>
                            No government has access. This is peer-to-peer. Canadian-to-Canadian.
                          </div>
                        </div>
                      </div>
                      <p className="mt-4 text-white font-semibold">
                        This is community-driven verification, not top-down control. It's Canadians taking back their online spaces from bots, trolls, and foreign manipulation.
                      </p>
                    </div>
                  </div>
                </div>

                <button
                  onClick={() => setScreen('dashboard')}
                  className="w-full bg-gradient-to-r from-red-600 to-red-800 py-4 rounded-xl font-bold text-lg hover:from-red-700 hover:to-red-900 transition"
                >
                  Back to Profile
                </button>

                <div className="text-center mt-8 pt-8 border-t border-slate-700">
                  <p className="text-xs text-slate-500">
                    ¬© {new Date().getFullYear()} Connexxia Inc. All rights reserved.
                  </p>
                </div>
              </div>
            </div>
          </>
        );
      }

      if (screen === 'setup') {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
              <div className="max-w-3xl mx-auto py-12">
                <div className="bg-slate-800 rounded-2xl p-8 border-2 border-red-500">
                  <div className="text-center mb-8">
                    <div className="text-5xl mb-4">üçÅ</div>
                    <h1 className="text-3xl font-bold mb-2">Create Username</h1>
                  </div>

                  <div className="mb-6">
                    <label className="block text-sm font-semibold text-red-300 mb-3">Legal Name</label>
                    <div className="grid grid-cols-2 gap-3 mb-4">
                      <input
                        type="text"
                        value={legalFirstName}
                        onChange={(e) => setLegalFirstName(e.target.value)}
                        className="px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                        placeholder="Legal first"
                      />
                      <input
                        type="text"
                        value={lastName}
                        onChange={(e) => setLastName(e.target.value)}
                        className="px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white"
                        placeholder="Last name"
                      />
                    </div>

                    <label className="block text-sm font-semibold text-red-300 mb-2">Preferred First (Optional)</label>
                    <input
                      type="text"
                      value={preferredFirstName}
                      onChange={(e) => setPreferredFirstName(e.target.value)}
                      className="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white mb-2"
                      placeholder="e.g., Mark (if legal is Marcus)"
                    />

                    <p className="text-xs text-slate-400 mt-2">
                      Username: <span className="text-white font-mono">
                        {legalFirstName && lastName ? `${(preferredFirstName || legalFirstName).toLowerCase()}.${lastName.toLowerCase()}` : 'firstname.lastname'}
                      </span>
                    </p>
                  </div>

                  <button onClick={claimUsername} className="w-full bg-red-600 py-3 rounded-lg font-semibold">
                    Join Network
                  </button>
                </div>
              </div>
            </div>
          </>
        );
      }

      if (!identity || !identity.displayUsername) {
        return (
          <>
            <InterestFormModal />
            <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4 flex items-center justify-center">
              <div className="text-center">
                <p className="text-xl mb-4">Loading...</p>
                <button onClick={() => setScreen('intro')} className="px-6 py-2 bg-red-600 rounded-lg">
                  Return to Start
                </button>
              </div>
            </div>
          </>
        );
      }

      const trustScore = getTrustScore();

      return (
        <>
          <InterestFormModal />
          <div className="min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 text-white p-4">
            <div className="max-w-6xl mx-auto py-8">
              <div className="bg-slate-800 rounded-2xl border-2 border-red-500 overflow-hidden mb-6">
                <div className="bg-gradient-to-r from-red-600 to-red-800 p-8">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-4">
                      <div className="text-3xl">üçÅ</div>
                      <div>
                        <h1 className="text-3xl font-bold">@{identity.displayUsername}</h1>
                        {identity.verifiedAddress && (
                          <p className="text-red-200 text-sm">{identity.verifiedAddress.city}, {identity.verifiedAddress.province}</p>
                        )}
                      </div>
                    </div>
                    <button onClick={resetApp} className="px-4 py-2 bg-white bg-opacity-20 rounded-lg text-sm">
                      Reset
                    </button>
                  </div>
                </div>

                {!identity.verified && (
                  <div className="bg-yellow-900 bg-opacity-20 border-t border-yellow-600 p-6">
                    <p className="text-yellow-200">Unverified - Attend a ceremony (3-10 people)</p>
                  </div>
                )}
              </div>

              <div className="grid md:grid-cols-2 gap-6">
                <div className="space-y-6">
                  <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h3 className="text-lg font-bold mb-4">Trust Score</h3>
                    <div className="text-4xl font-bold mb-4">{trustScore}/100</div>
                    <div className="w-full bg-slate-700 rounded-full h-4 mb-4">
                      <div className="bg-gradient-to-r from-red-500 to-red-700 h-4 rounded-full" style={{ width: `${trustScore}%` }}></div>
                    </div>
                    <button
                      onClick={() => setScreen('trustScoreInfo')}
                      className="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm transition flex items-center justify-center gap-2"
                    >
                      <AlertCircle className="w-4 h-4" />
                      What does this mean?
                    </button>
                  </div>

                  {!showCeremony ? (
                    <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                      <h3 className="text-lg font-bold mb-4">Ceremonies</h3>
                      <div className="bg-slate-900 rounded-lg p-4">
                        <div className="font-semibold text-sm">Tim Hortons, Yonge &amp; Bloor</div>
                        <div className="text-xs text-slate-400">Toronto</div>
                        <button onClick={joinCeremony} className="w-full mt-3 px-4 py-2 bg-red-600 rounded-lg text-sm">
                          Open Mobile App
                        </button>
                      </div>
                    </div>
                  ) : (
                    <div className="bg-slate-800 rounded-xl p-6 border-2 border-red-500">
                      {ceremonyStep === 'discover' && (
                        <>
                          <h3 className="text-lg font-bold mb-4">Discovering Nearby</h3>
                          <div className="space-y-2 mb-4">
                            {nearbyUsers.map((user) => (
                              <div
                                key={user.displayUsername}
                                onClick={() => toggleUserSelection(user.displayUsername)}
                                className={`p-3 rounded-lg cursor-pointer ${
                                  selectedUsers.includes(user.displayUsername)
                                    ? 'bg-green-900 bg-opacity-50 border-2 border-green-500'
                                    : 'bg-slate-900 border border-slate-700'
                                }`}
                              >
                                <div className="flex items-center justify-between">
                                  <div>
                                    <div className="font-semibold text-sm">@{user.displayUsername}</div>
                                    <div className="text-xs text-slate-400">{user.distance}</div>
                                  </div>
                                  {user.verified && <CheckCircle className="w-4 h-4 text-green-400" />}
                                </div>
                              </div>
                            ))}
                          </div>
                          <p className="text-sm text-slate-300 mb-4">Selected: {selectedUsers.length}</p>
                          <div className="flex gap-2">
                            <button
                              onClick={proceedToSigning}
                              disabled={selectedUsers.length < 2}
                              className="flex-1 px-4 py-2 bg-green-600 rounded-lg text-sm disabled:bg-slate-600"
                            >
                              Form Quorum ‚Üí
                            </button>
                            <button onClick={closeCeremony} className="px-4 py-2 bg-slate-700 rounded-lg text-sm">
                              Cancel
                            </button>
                          </div>
                        </>
                      )}

                      {ceremonyStep === 'verify' && (
                        <>
                          <h3 className="text-lg font-bold mb-4">Verify Each Person</h3>
                          <div className="space-y-4 mb-4">
                            {selectedUsers.map((displayUsername) => (
                              <div key={displayUsername} className="bg-slate-900 rounded-lg p-4">
                                <div className="font-semibold text-sm mb-3">@{displayUsername}</div>
                                <div className="space-y-2">
                                  <label className="flex items-start gap-3 cursor-pointer">
                                    <input
                                      type="checkbox"
                                      checked={verificationChecks[displayUsername]?.identity || false}
                                      onChange={() => toggleVerificationCheck(displayUsername, 'identity')}
                                      className="mt-1 w-4 h-4"
                                    />
                                    <div className="text-xs">Name matches ID</div>
                                  </label>
                                  <label className="flex items-start gap-3 cursor-pointer">
                                    <input
                                      type="checkbox"
                                      checked={verificationChecks[displayUsername]?.citizenship || false}
                                      onChange={() => toggleVerificationCheck(displayUsername, 'citizenship')}
                                      className="mt-1 w-4 h-4"
                                    />
                                    <div className="text-xs">Canadian citizen/resident</div>
                                  </label>
                                  <label className="flex items-start gap-3 cursor-pointer">
                                    <input
                                      type="checkbox"
                                      checked={verificationChecks[displayUsername]?.address || false}
                                      onChange={() => toggleVerificationCheck(displayUsername, 'address')}
                                      className="mt-1 w-4 h-4"
                                    />
                                    <div className="text-xs">Address verified</div>
                                  </label>
                                </div>
                              </div>
                            ))}
                          </div>
                          <button
                            onClick={() => allChecksComplete() && setCeremonyStep('sign')}
                            disabled={!allChecksComplete()}
                            className="w-full px-4 py-2 bg-blue-600 rounded-lg disabled:bg-slate-600"
                          >
                            Continue ‚Üí
                          </button>
                        </>
                      )}

                      {ceremonyStep === 'sign' && (
                        <>
                          <h3 className="text-lg font-bold mb-4">Sign Attestations</h3>
                          <p className="text-sm mb-4">All {selectedUsers.length + 1} participants will sign</p>
                          <button onClick={completeCeremony} className="w-full px-4 py-3 bg-yellow-600 rounded-lg font-semibold">
                            Sign with Private Key üîë
                          </button>
                        </>
                      )}

                      {ceremonyStep === 'complete' && (
                        <>
                          <h3 className="text-lg font-bold mb-4">Ceremony Complete!</h3>
                          <div className="bg-green-900 bg-opacity-20 border border-green-600 rounded-lg p-4 mb-4">
                            <p className="text-green-200 font-semibold mb-2">‚úì Success!</p>
                            <p className="text-sm text-green-100">You received {selectedUsers.length} vouches</p>
                          </div>

                          <div className="bg-blue-900 bg-opacity-20 border border-blue-500 rounded-lg p-4 mb-4">
                            <p className="text-sm text-blue-200">
                              <strong>üçÅ Like what you see?</strong> Reserve your username and get notified when we launch!
                            </p>
                          </div>

                          <div className="flex gap-2">
                            <button onClick={closeCeremony} className="flex-1 px-4 py-2 bg-red-600 rounded-lg">
                              Done
                            </button>
                            <button
                              onClick={() => {
                                closeCeremony();
                                setShowInterestForm(true);
                              }}
                              className="flex-1 px-4 py-2 bg-blue-600 rounded-lg flex items-center justify-center gap-2"
                            >
                              <User className="w-4 h-4" />
                              Reserve Username
                            </button>
                          </div>
                        </>
                      )}
                    </div>
                  )}
                </div>

                <div className="space-y-6">
                  <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h3 className="text-lg font-bold mb-4">How It Works</h3>
                    <div className="space-y-2 text-sm text-slate-300">
                      <p>‚Ä¢ 3-10 people meet in person</p>
                      <p>‚Ä¢ Verify each other's identity</p>
                      <p>‚Ä¢ All sign cryptographically</p>
                      <p>‚Ä¢ Each gets N-1 vouches</p>
                    </div>
                  </div>

                  {identity.verified && (
                    <>
                      <div className="bg-gradient-to-r from-red-600 to-red-800 rounded-xl p-6">
                        <div className="text-center">
                          <div className="text-5xl mb-3">üçÅ</div>
                          <h3 className="font-bold text-xl mb-2">Verified Canadian</h3>
                          <p className="text-red-100 text-sm">Multi-signature verified</p>
                        </div>
                      </div>

                      <div className="bg-blue-900 bg-opacity-30 border-2 border-blue-500 rounded-xl p-6">
                        <div className="text-center">
                          <User className="w-12 h-12 text-blue-300 mx-auto mb-3" />
                          <h3 className="font-bold text-lg mb-2">Want to make this real?</h3>
                          <p className="text-sm mb-4">Reserve your username and get notified when we launch</p>
                          <button
                            onClick={() => setShowInterestForm(true)}
                            className="w-full bg-blue-600 py-3 rounded-lg font-semibold flex items-center justify-center gap-2"
                          >
                            <Mail className="w-5 h-5" />
                            Reserve @{identity.displayUsername}
                          </button>
                        </div>
                      </div>
                    </>
                  )}
                </div>
              </div>
            </div>

            <div className="text-center mt-8 pb-8">
              <p className="text-xs text-slate-500">
                ¬© {new Date().getFullYear()} Connexxia Inc. All rights reserved.
              </p>
            </div>

            <button
              onClick={() => setShowInterestForm(true)}
              className="fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-2 font-semibold transition-all hover:scale-105 z-40"
            >
              <User className="w-5 h-5" />
              Reserve Username
            </button>
          </div>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CanadianIdentityApp />);
  </script>

</body>
</html>
